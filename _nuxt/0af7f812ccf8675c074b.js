(window.webpackJsonp=window.webpackJsonp||[]).push([[6,7,9],{152:function(e,t,n){"use strict";n.r(t);n(148);var r={name:"listing-preview",props:{doc:Object,index:Number,idFieldName:{type:String,default:"id"},thePage:Object},computed:{previewThumbnail:function(){return this.doc.hasOwnProperty("img.uri.thumbnail")?this.doc["img.uri.thumbnail"][0]:"no image"},previewTitle:function(){return this.doc.title},previewDesc:function(){return this.doc.teaser}},data:function(){return{showCarousels:!1}},methods:{showSlides:function(){console.log(this.doc)}}},l=n(11),component=Object(l.a)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-card",{staticClass:"mb-2"},[n("div",{staticClass:"d-flex flex-no-wrap justify-space-between"},[n("v-avatar",{attrs:{size:"180",tile:""}},[n("v-img",{attrs:{src:e.previewThumbnail,"max-width":"180"},on:{click:function(t){t.stopPropagation(),e.showCarousels=!0}}})],1),n("div",[n("v-card-title",[e._v(e._s(e.previewTitle))]),n("v-card-text",[e._v(e._s(e.previewDesc))])],1)],1),n("v-dialog",{attrs:{"max-width":"860"},model:{value:e.showCarousels,callback:function(t){e.showCarousels=t},expression:"showCarousels"}},[n("v-carousel",{attrs:{height:"600"}},e._l(e.doc["img.uri.preview"],(function(e,i){return n("v-carousel-item",{key:i,attrs:{src:e}})})),1)],1)],1)}),[],!1,null,null,null);t.default=component.exports},153:function(e,t,n){"use strict";n.r(t);var r={name:"facet-buckets",props:["facets"],methods:{bucketValue:function(e){return console.log(e),e}}},l=n(11),component=Object(l.a)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-expansion-panels",e._l(e.facets,(function(t,r){return n("v-expansion-panel",{key:"facet-"+r,class:{"grey lighten-2":r%2==0}},[n("v-expansion-panel-header",[e._v(e._s(t.name)+" - "+e._s(t.buckets.length))]),n("v-expansion-panel-content",[n("v-list",{class:{"grey lighten-2":r%2==0}},[n("v-list-item-group",e._l(t.buckets,(function(r,i){return n("v-list-item",{key:"bucket-"+i,on:{click:function(n){return e.$emit("bucket-select",t.name,r.value)}}},[n("v-list-item-content",[e._v(e._s(r.value))]),n("v-list-item-action",[n("v-list-item-action-text",[e._v(e._s(r.count))])],1)],1)})),1)],1)],1)],1)})),1)}),[],!1,null,null,null);t.default=component.exports},154:function(e,t,n){"use strict";n.r(t);var r={name:"query-filters",props:["filters"],computed:{}},l=n(11),component=Object(l.a)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.filters?n("v-card",{staticClass:"mb-3"},[n("v-list",{staticClass:"indigo lighten-4"},[n("v-subheader",[e._v("Filters")]),n("v-list-item-group",e._l(e.filters,(function(filter,i){return n("v-list-item",{key:"filter-"+i,on:{click:function(t){return e.$emit("filter-select",filter)}}},[n("v-list-item-content",[e._v(e._s(filter.replace(":",": ")))]),n("v-list-item-action",[n("v-list-item-action-text",[e._v("X")])],1)],1)})),1)],1)],1):e._e()}),[],!1,null,null,null);t.default=component.exports},188:function(e,t,n){"use strict";n.r(t);n(71),n(35);var r=n(46),l=(n(24),n(15),n(52),n(98),n(69),n(70),n(97),n(156)),o=n.n(l),c=n(152),f=n(153),d=n(154);function v(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}var h={components:{"listing-preview":c.default,"facet-buckets":f.default,"query-filters":d.default},layout:"vuetify",name:"solrsearch",data:function(){return{settingsDialog:!1,query:"*:*",valid:!1,idField:"id",collectionUrl:"http://search.example.com",collections:[],collectionLabel:"Collection: ",allFields:["abc","cde"],facetFields:[],facetInput:null,allCities:["Toronto","Markham"],cities:["Toronto","Markham"],cityInput:null,allNeighbours:["Toronto","Markham"],neighbours:["Toronto","Markham"],neighbourInput:null,filterQuery:"",sort:"",fieldList:"",boostQuery:"",boostFunction:"",queryFields:"",priceRangeOn:!1,priceRange:[5e5,1e6],totalHits:0,totalPages:0,facets:null,stats:null,results:null,resultSummary:"",debugQuery:!1,debugExplain:null,explainItem:null,currentPage:1,perPage:15,profileRepo:"/nuxt-repo/",profileName:"local.json"}},computed:{filters:function(){return""===this.filterQuery?null:this.filterQuery.split("||")}},methods:{simpleSearch:function(){var e=this;e.resultSummary="Searching ...",e.results=null,e.facets=null,e.stats=null,e.query||(e.query="*:*");var t=e.buildQuery();e.jeQueryParams&&(e.jeQueryParams.setMode("view"),e.jeQueryParams.set(t),e.jeQueryParams.expandAll(),e.jeQueryParams.setMode("code"));var n=e.collectionUrl+"select";o.a.post(n,t).then((function(n){e.totalHits=n.data.response.numFound,e.totalPages=Math.ceil(e.totalHits/e.perPage),e.results=n.data.response.docs,n.data.hasOwnProperty("debug")&&(e.debugExplain=n.data.debug),n.data.hasOwnProperty("facet_counts")&&(e.facets=e.getReadyFacets(n.data.facet_counts.facet_fields));var r=t.params.start;e.resultSummary="Showing "+(r+1)+" - "+Math.min(r+e.perPage,e.totalHits)+" of "+e.totalHits+" Items",e.totalHits>0&&console.log("total hits: "+e.totalHits)})).catch((function(t){e.resultSummary="Query Error!",console.log(t)}))},buildQuery:function(){var e=(this.currentPage-1)*this.perPage,t=Object.assign({rows:this.perPage,defType:"edismax",start:e,sort:this.sort,debugQuery:this.debugQuery},this.getFacetFields(),this.getFieldList(),this.getFilterQuery(),this.getBoostQuery(),this.getBoostFunction(),this.getQueryFields());return{query:this.query,params:t}},getFacetFields:function(){return this.facetFields.length<1?{}:{facet:"on","facet.limit":-1,"facet.field":this.facetFields}},getFieldList:function(){if(""===this.fieldList)return{};var e=this.fieldList.split(",");return e.includes(this.idField)||e.push(this.idField),{fl:e}},getBoostFunction:function(){return""===this.boostFunction?{}:{bf:this.boostFunction}},getBoostQuery:function(){return""===this.boostQuery?{}:{bq:this.boostQuery}},getQueryFields:function(){return""===this.queryFields?{}:{qf:this.queryFields}},getFilterQuery:function(){var e=[];if(""!=this.filterQuery&&((e=this.filterQuery.split("||")).length>0&&(e=e.filter((function(e){return!(e.startsWith("listvalue_i")||e.startsWith("city"))}))),this.filterQuery=e.join("||")),this.priceRangeOn){var t="listvalue_i:["+this.priceRange[0]+" TO "+this.priceRange[1]+"]";e.push(t),this.filterQuery=e.join("||")}return this.cities.length>0&&(e.push('city:("'+this.cities.join('","')+'")'),this.filterQuery=e.join("||")),""===this.filterQuery?{}:{fq:this.filterQuery.split("||")}},getReadyFacets:function(e){var t=[];return Object.keys(e).forEach((function(n){for(var r=e[n],l=[],i=0;i<r.length;i+=2)r[i+1]<1||l.push({value:r[i],count:r[i+1]});var o={label:n,name:n,buckets:l};t.push(o)})),t},handleSearchButton:function(){this.currentPage=1,this.simpleSearch()},handleBucketSelect:function(e,t){var n=e+':"'+t+'"';this.filterQuery=""===this.filterQuery?n:this.filterQuery+"||"+n,this.currentPage=1,this.simpleSearch()},removeFilter:function(filter){var e=this.filterQuery.split("||").filter((function(e){return e!=filter}));switch(this.filterQuery=e.join("||"),filter.split(":")[0]){case"listvalue_i":this.priceRangeOn=!1}this.currentPage=1,this.simpleSearch()},removeCitySelection:function(e){var t=this.cities.indexOf(e);t>=0&&this.cities.splice(t,1)},removeFacetSelection:function(e){console.log("selected facet:",e);var t=this.facetFields.indexOf(e);t>=0&&this.facetFields.splice(t,1)},facetSelectionChange:function(){},settingsCancel:function(){this.settingsDialog=!1},settingsOk:function(){this.settingsDialog=!1,this.simpleSearch()},settingsSave:function(){var e=this;console.log(e._data);var t=Object.keys(e._data).filter((function(t){return"function"!=typeof e._data[t]}));console.log(t);var n=t.reduce((function(t,n){return function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?v(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):v(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({},t,Object(r.a)({},n,e._data[n]))}),{});console.log(n),console.log(JSON.stringify(n)),this.settingsDialog=!1},loadProfile:function(){var e=this,t=e.profileRepo+e.profileName;o.a.get(t).then((function(t){Object.keys(t.data).forEach((function(n){"files"===n?t.data[n].forEach((function(t){o.a.get(e.profileRepo+t.fileName).then((function(n){e[t.fieldName]=n.data.split("\n")}))})):e[n]=t.data[n]}))}))}}},m=n(11),component=Object(m.a)(h,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",{attrs:{"grid-list-xs":""}},[n("v-card",{staticClass:"d-flex flex-row",attrs:{flat:"",tile:""}},[n("v-text-field",{attrs:{dense:"",id:"input-number",autocomplete:"off",label:"Type your query here"},model:{value:e.query,callback:function(t){e.query=t},expression:"query"}}),n("v-btn",{staticClass:"pa-2",attrs:{color:"warning",dark:"",icon:""},on:{click:e.handleSearchButton}},[n("v-icon",[e._v("mdi-magnify")]),e._v("search")],1),n("v-btn",{staticClass:"pa-2",attrs:{color:"success darken-1",dark:"",icon:""},on:{click:function(t){t.stopPropagation(),e.settingsDialog=!0}}},[n("v-icon",[e._v("mdi-settings")]),e._v("settings")],1)],1),n("v-dialog",{attrs:{"max-width":"780px",persistent:""},model:{value:e.settingsDialog,callback:function(t){e.settingsDialog=t},expression:"settingsDialog"}},[n("v-card",[n("v-toolbar",{attrs:{flat:"",color:"primary",dark:""}},[n("v-toolbar-title",[e._v("Search settings")])],1),n("v-tabs",[n("v-tab",[n("v-icon",{attrs:{left:""}},[e._v("mdi-settings")]),e._v("Settings")],1),n("v-tab",[n("v-icon",{attrs:{left:""}},[e._v("mdi-account")]),e._v("Profiles")],1),n("v-tab-item",[n("v-card",{attrs:{flat:""}},[n("v-card-text",[n("v-form",{model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[n("v-row",[n("v-col",{attrs:{cols:"12",md:"10"}},[n("v-text-field",{attrs:{label:"Solr Collection URL:",dense:""},model:{value:e.collectionUrl,callback:function(t){e.collectionUrl=t},expression:"collectionUrl"}})],1),n("v-col",{attrs:{cols:"12",md:"2"}},[n("v-checkbox",{attrs:{label:"Debug",dense:""},model:{value:e.debugQuery,callback:function(t){e.debugQuery=t},expression:"debugQuery"}})],1)],1),n("v-row",[n("v-col",{attrs:{cols:"12",md:"3"}},[n("v-text-field",{attrs:{label:"Items Per Page:",dense:""},model:{value:e.perPage,callback:function(t){e.perPage=t},expression:"perPage"}})],1),n("v-col",{attrs:{cols:"12",md:"9"}},[n("v-text-field",{attrs:{label:"Sort:",dense:""},model:{value:e.sort,callback:function(t){e.sort=t},expression:"sort"}})],1)],1),n("v-row",[n("v-col",{attrs:{cols:"12",md:"12"}},[n("v-autocomplete",{attrs:{label:"Cities:",items:e.allCities,multiple:"","search-input":e.cityInput,dense:"",chips:"","small-chips":""},on:{input:function(t){e.cityInput=null},"update:searchInput":function(t){e.cityInput=t},"update:search-input":function(t){e.cityInput=t}},scopedSlots:e._u([{key:"selection",fn:function(data){return[n("v-chip",{attrs:{close:""},on:{"click:close":function(t){return e.removeCitySelection(data.item)}}},[e._v(e._s(data.item))])]}}]),model:{value:e.cities,callback:function(t){e.cities=t},expression:"cities"}})],1)],1),n("v-row",[n("v-col",{attrs:{cols:"12",md:"3"}},[n("v-checkbox",{staticClass:"mt-0 pt-0",attrs:{label:"Price Range",dense:""},model:{value:e.priceRangeOn,callback:function(t){e.priceRangeOn=t},expression:"priceRangeOn"}})],1),n("v-col",{attrs:{cols:"12",md:"9"}},[n("v-range-slider",{attrs:{disabled:!e.priceRangeOn,max:"5000000",min:"10000",step:"10000","hide-details":"",dense:""},scopedSlots:e._u([{key:"prepend",fn:function(){return[n("span",{domProps:{textContent:e._s(e.priceRange[0])}})]},proxy:!0},{key:"append",fn:function(){return[n("span",{domProps:{textContent:e._s(e.priceRange[1])}})]},proxy:!0}]),model:{value:e.priceRange,callback:function(t){e.priceRange=t},expression:"priceRange"}})],1)],1),n("v-row",[n("v-col",{attrs:{cols:"12",md:"12"}},[n("v-autocomplete",{attrs:{label:"Facets:",items:e.allFields,multiple:"","search-input":e.facetInput,dense:"",chips:"","small-chips":""},on:{change:e.facetSelectionChange,input:function(t){e.facetInput=null},"update:searchInput":function(t){e.facetInput=t},"update:search-input":function(t){e.facetInput=t}},scopedSlots:e._u([{key:"selection",fn:function(data){return[n("v-chip",{attrs:{close:""},on:{"click:close":function(t){return e.removeFacetSelection(data.item)}}},[e._v(e._s(data.item))])]}}]),model:{value:e.facetFields,callback:function(t){e.facetFields=t},expression:"facetFields"}})],1)],1)],1)],1)],1)],1),n("v-tab-item",[n("v-card",{attrs:{flat:""}},[n("v-card-text",[n("v-form",[n("v-row",[n("v-col",{attrs:{cols:"12",md:"12"}},[n("v-text-field",{attrs:{label:"Profile Repository URL:",autocomplete:"on",dense:""},model:{value:e.profileRepo,callback:function(t){e.profileRepo=t},expression:"profileRepo"}})],1)],1),n("v-row",[n("v-col",{attrs:{cols:"12",md:"9"}},[n("v-text-field",{attrs:{label:"Pick Profile:",dense:""},model:{value:e.profileName,callback:function(t){e.profileName=t},expression:"profileName"}})],1),n("v-col",{attrs:{cols:"12",md:"3"}},[n("v-btn",{on:{click:e.loadProfile}},[e._v("Load")])],1)],1)],1)],1)],1)],1)],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:e.settingsCancel}},[e._v("cancel")]),n("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:e.settingsOk}},[e._v("Ok")])],1)],1)],1),n("v-layout",{attrs:{row:"",wrap:""}},[n("v-row",[n("v-col",{attrs:{cols:"12",md:"3"}},[n("h3",[e._v("Facets")]),n("query-filters",{attrs:{filters:e.filters},on:{"filter-select":e.removeFilter}}),n("facet-buckets",{attrs:{facets:e.facets},on:{"bucket-select":e.handleBucketSelect}})],1),n("v-col",{attrs:{cols:"12",md:"9"}},[n("h3",[e._v(e._s(e.resultSummary))]),e.results?n("v-pagination",{attrs:{length:e.totalPages,"total-visible":"10"},on:{input:e.simpleSearch},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}}):e._e(),e._l(e.results,(function(t,r){return n("listing-preview",{key:t.id,attrs:{doc:t,index:r,idFieldName:e.idField}})})),e.results?n("v-pagination",{attrs:{length:e.totalPages,"total-visible":"10"},on:{input:e.simpleSearch},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}}):e._e()],2)],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports}}]);